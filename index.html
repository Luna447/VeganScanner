<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vegan Scanner</title>
  <meta name="theme-color" content="#0f766e">

  <style>
    html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial;background:#0b1212;color:#e6f2ef}
    header{padding:16px;background:#0f766e;color:#fff;font-weight:700}
    main{padding:16px;max-width:860px;margin:auto;display:grid;gap:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    button{background:#0f766e;color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
    details{background:#0e1a19;border:1px solid #123534;border-radius:10px;padding:10px}
    pre{white-space:pre-wrap;word-break:break-word;background:#091212;padding:12px;border-radius:8px}
    .muted{opacity:.8;font-size:.9rem}
  </style>
</head>
<body>
  <header>Vegan-Check (offline + hybrid)</header>
  <main>
    <div class="row">
      <input id="file" type="file" accept="image/*">
      <button id="scanBtn">Scannen</button>
      <button id="resetBtn">Zurücksetzen</button>
      <span id="status" class="muted"></span>
    </div>

    <details>
      <summary>Zutaten-Text (OCR)</summary>
      <pre id="ocrOut"></pre>
    </details>

    <details>
      <summary>Treffer</summary>
      <pre id="hitsOut">Noch keine Logik hier. Erst OCR reparieren, danach Regeln.</pre>
    </details>

    <p class="muted">
      Hinweis: OCR läuft lokal mit Tesseract; Sprachdaten liegen im Projekt (kein CDN, kein CORS).
    </p>
  </main>

  <!-- Tesseract lokal laden -->
  <script src="vendor/tesseract/tesseract.min.js"></script>
  <script src="app.js"></script>

  <!-- Failsafe: alte Service-Worker rausschmeißen -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations()
        .then(rs => rs.forEach(r => r.unregister()));
      caches && caches.keys && caches.keys().then(k => k.forEach(c => caches.delete(c)));
    }
  </script>
  
  <!-- Optionales Failsafe -->
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(rs => rs.forEach(r => r.unregister()));
  caches?.keys?.().then(keys => keys.forEach(k => caches.delete(k)));
}
</script>

  
  
</body>
</html>
